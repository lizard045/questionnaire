# NKUST 問卷自動填寫系統 📝

自動填寫國立高雄科技大學期末問卷系統，支援多種題型和智能錯誤處理。

## 🚀 主要功能

- **自動登入**: 支援帳號密碼登入（需手動完成reCAPTCHA驗證）
- **智能導航**: 自動導航到期末問卷填寫頁面
- **多題型支援**: 單選題、複選題、下拉選單、文字評論
- **隨機填寫**: 智能隨機作答，偏向正面答案
- **複選題智能處理**: 特別處理8-1題等複選題，隨機選擇1-3個選項
- **錯誤恢復**: 智能錯誤處理和自動重試機制
- **詳細統計**: 完整的填寫進度和結果統計

## 📋 更新日誌 (最新修正)

### ✅ 修正問題
1. **Stale Element 錯誤**: 修正頁面刷新後按鈕元素失效的問題
2. **瀏覽器會話管理**: 增加會話失效檢測和處理
3. **按鈕重新獲取**: 每次操作前重新搜尋按鈕避免元素失效
4. **智能頁面導航**: 增加頁面狀態檢測和自動重導向
5. **重試機制**: 增加最多3次重試處理，提高成功率
6. **必填欄位檢查**: 防止出現「請填寫原因」等錯誤訊息
7. **提交前最終檢查**: 送出前自動檢查並補填所有空白欄位
8. **手動 reCAPTCHA 驗證**: 使用按鍵等待，在 BAT 環境下更穩定
9. **多重元素搜尋**: 使用多種選擇器尋找頁面元素，提高成功率

### 🎯 流程改進
- **穩定的元素搜尋**: 使用多種方法搜尋問卷按鈕
- **智能錯誤處理**: 區分不同類型的錯誤並採取相應措施
- **頁面狀態監控**: 確保始終在正確頁面操作
- **滾動和等待**: 改進元素可見性和載入等待

## 📦 系統需求

- Windows 10/11
- Microsoft Edge 瀏覽器
- Python 3.7+

## 🛠️ 安裝步驟

1. **安裝依賴項目**:
   ```
   雙擊執行: install_requirements.bat
   ```

2. **配置設定**:
   編輯 `config.py` 修改您的學號密碼

3. **執行程式**:
   ```
   python auto_questionnaire.py
   ```

## ⚙️ 配置說明

在 `config.py` 中設定：

```python
# 學生帳號資訊
STUDENT_ID = "C111110157"    # 您的學號
PASSWORD = "Leo237827848"    # 您的密碼

# 系統設定
QUESTIONNAIRE_URL = "https://ceq.nkust.edu.tw/StuFillIn"
BROWSER_WAIT_TIME = 10  # 等待時間（秒）
```

## 🎮 使用方式

### 🚀 簡單使用（推薦）
直接雙擊執行 `執行問卷填寫.bat` 檔案即可！

### 📝 詳細步驟
1. **啟動程式**: 雙擊 `執行問卷填寫.bat` 或執行 `python auto_questionnaire.py`
2. **手動驗證**: 在 reCAPTCHA 出現時手動完成驗證
3. **按鍵繼續**: 完成驗證後按任意鍵讓程式繼續
4. **自動處理**: 程式會自動完成所有後續步驟
5. **查看結果**: 觀察控制台輸出了解處理進度

## 📊 支援題型

| 題型 | 處理方式 | 說明 |
|------|----------|------|
| 單選題 | 隨機選擇（偏向正面） | 優先選擇後3個選項 |
| 複選題 | 智能多選 | 8-1題隨機勾選1-3個選項 |
| 下拉選單 | 隨機選擇 | 跳過第一個選項 |
| 文字評論 | 預設回覆 | 正面評價文字 |

## 🔧 錯誤處理機制

- **Stale Element**: 自動重新獲取頁面元素
- **會話失效**: 檢測瀏覽器連接狀態
- **按鈕找不到**: 多種搜尋策略
- **網路超時**: 自動重試最多3次
- **頁面跳轉**: 智能頁面狀態監控

## 🚨 注意事項

- 需要手動完成 reCAPTCHA 驗證
- 請確保網路連接穩定
- 程式執行期間請勿關閉瀏覽器
- 建議在問卷填寫期間內使用
- 支援 Microsoft Edge 瀏覽器

## 🐛 故障排除

**問題**: 找不到問卷按鈕
- **解決**: 確認已在問卷期間，重新執行程式

**問題**: 瀏覽器會話失效
- **解決**: 程式會自動檢測並提示重新啟動

**問題**: 登入失敗
- **解決**: 檢查學號密碼是否正確，手動完成驗證碼

**問題**: 填寫不完整
- **解決**: 程式會自動重試，確保所有題目都被填寫

## 📈 執行統計

程式會顯示詳細的執行統計：
- 處理的問卷數量
- 各種題型的填寫數量
- 錯誤和重試次數
- 總完成時間

## 🔒 安全說明

- 程式僅在本機執行，不會上傳任何資料
- 帳號密碼僅用於系統登入
- 建議使用後修改密碼以確保安全

## 📞 技術支援

如遇到問題，請檢查：
1. 網路連接狀態
2. 瀏覽器版本是否最新
3. 問卷系統是否正常運作
4. 配置文件是否正確設定

---

> **免責聲明**: 此工具僅供學習和研究用途，使用者需自行承擔使用風險並遵守學校相關規定。 